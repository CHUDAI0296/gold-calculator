<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Precious Metal Market Charts - Gold, Silver, Platinum Price History</title>
    <meta name="description" content="Track precious metal prices with our interactive charts. View historical gold, silver, and platinum price data and market trends.">
    <link rel="canonical" href="https://www.goldcalculator.click/market.html" />
    <!-- Critical Resource Preloads -->
    <link rel="preload" href="css/styles.css" as="style">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js" as="script">
    <!-- DNS Prefetch for performance -->
    <link rel="dns-prefetch" href="//cdn.jsdelivr.net">
    <link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
    <link rel="dns-prefetch" href="//www.googletagmanager.com">
    <link rel="dns-prefetch" href="//pagead2.googlesyndication.com">
    <!-- Critical CSS Inline -->
    <style>
        :root{--gold-primary:#D4AF37;--gold-secondary:#FFD700;--gold-dark:#B8860B;--gold-light:#FFF8DC;--silver-primary:#C0C0C0;--platinum-primary:#E5E4E2}
        body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;color:#333;margin:0}
        .navbar-brand{display:flex;align-items:center;font-weight:bold;font-size:1.5rem}
        .gold-icon{color:#FFD700;font-size:1.5rem;margin-right:10px}
        .silver-icon{color:var(--silver-primary);margin-right:8px}
        .platinum-icon{color:var(--platinum-primary);margin-right:8px}
        .price-box{font-size:2rem;font-weight:700;margin:1rem 0}
        .gold-price{color:var(--gold-dark)}
        .silver-price{color:var(--silver-primary)}
        .platinum-price{color:var(--platinum-primary)}
        .market-hero{background-color:#f8f9fa;padding:3rem 0}
        .chart-container{min-height:400px;position:relative}
        @media(max-width:768px){.price-box{font-size:1.5rem}}
    </style>

    <link rel="stylesheet" href="css/styles.css">
    <!-- Async CSS Loading -->
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"></noscript>
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"></noscript>
    
    <!-- Baidu Analytics -->
    <script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?3d4d36f5314954e7ca6dc33b6a81373b";
            var s = document.getElementsByTagName("script")[0]; 
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
    <script type='text/javascript' src='//pl28024779.effectivegatecpm.com/59/09/19/59091957719b6779cd1f4af7ac8b5068.js'></script>
    <!-- Microsoft Clarity -->
    <script type="text/javascript">
      (function(c,l,a,r,i,t,y){
          c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
          t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
          y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
      })(window, document, "clarity", "script", "u3xxjqx9t5");
    </script>
</head>
<body>
    <!-- Header Section -->
    <header class="bg-dark text-white">
        <nav class="navbar navbar-expand-lg navbar-dark">
            <div class="container">
                <a class="navbar-brand" href="index.html">
                    <i class="fas fa-coins gold-icon"></i> Gold Calculator
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item">
                            <a class="nav-link" href="index.html">Home</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="calculator.html">Gold Calculator</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="metals.html">Other Metals</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="market.html">Market Charts</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="multi-calculator.html">Batch Calculator</a>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="educationDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                Education
                            </a>
                            <ul class="dropdown-menu" aria-labelledby="educationDropdown">
                                <li><a class="dropdown-item" href="gold-education.html">Gold Education</a></li>
                                <li><a class="dropdown-item" href="silver-guide.html">Silver Guide</a></li>
                                <li><a class="dropdown-item" href="gold-history.html">Gold History</a></li>
                                <li><a class="dropdown-item" href="investment-guide.html">Investment Guide</a></li>
                            </ul>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="servicesDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Services</a>
                            <ul class="dropdown-menu" aria-labelledby="servicesDropdown">
                                <li><a class="dropdown-item" href="refining-services.html">Refining Services</a></li>
                                <li><a class="dropdown-item" href="dealer-program.html">Dealer Program</a></li>
                            </ul>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="pricingDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">Pricing</a>
                            <ul class="dropdown-menu" aria-labelledby="pricingDropdown">
                                <li><a class="dropdown-item" href="coin-melt-values.html">Coin Melt Values</a></li>
                                <li><a class="dropdown-item" href="live-karat-prices.html">Live Karat Prices</a></li>
                            </ul>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="about.html">About Us</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="contact.html">Contact</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
    </header>

    <!-- Market Hero Section -->
    <section class="market-hero py-5 bg-light">
        <div class="container text-center">
            <h1 class="display-4">Precious Metal Market Charts</h1>
            <p class="lead">Track historical prices and market trends</p>
            
            <!-- Current Prices Display -->
            <div class="row mt-4">
                <div class="col-md-4 mb-3">
                    <div class="card h-100">
                        <div class="card-body">
                            <h3>Gold <i class="fas fa-coins gold-icon"></i></h3>
                            <div class="price-box gold-price">
                                <span id="current-gold-price">Loading...</span> USD/oz
                            </div>
                            <div class="price-change" id="gold-price-change">
                                <span class="change-value">--</span>
                                <span class="change-percent">--</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 mb-3">
                    <div class="card h-100">
                        <div class="card-body">
                            <h3>Silver <i class="fas fa-coins silver-icon"></i></h3>
                            <div class="price-box silver-price">
                                <span id="current-silver-price">Loading...</span> USD/oz
                            </div>
                            <div class="price-change" id="silver-price-change">
                                <span class="change-value">--</span>
                                <span class="change-percent">--</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 mb-3">
                    <div class="card h-100">
                        <div class="card-body">
                            <h3>Platinum <i class="fas fa-coins platinum-icon"></i></h3>
                            <div class="price-box platinum-price">
                                <span id="current-platinum-price">Loading...</span> USD/oz
                            </div>
                            <div class="price-change" id="platinum-price-change">
                                <span class="change-value">--</span>
                                <span class="change-percent">--</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <p class="small text-muted mt-2">Last updated: <span id="last-updated">Loading...</span></p>
        </div>
    </section>

    <!-- Chart Section -->
    <section class="chart-section py-5">
        <div class="container">
            <div class="card mb-4">
                <div class="card-header">
                    <div class="row align-items-center">
                        <div class="col-md-6">
                            <h2 class="mb-0">Price History Chart</h2>
                        </div>
                        <div class="col-md-6 text-md-end">
                            <!-- Time Range Selector -->
                            <div class="btn-group" role="group" aria-label="Time range selector">
                                <button type="button" class="btn btn-outline-primary time-range-btn active" data-range="7">7 Days</button>
                                <button type="button" class="btn btn-outline-primary time-range-btn" data-range="30">30 Days</button>
                                <button type="button" class="btn btn-outline-primary time-range-btn" data-range="90">90 Days</button>
                                <button type="button" class="btn btn-outline-primary time-range-btn" data-range="365">1 Year</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <div class="chart-container" style="position: relative; height:60vh; width:100%">
                    <canvas id="priceHistoryChart"></canvas>
                    <div id="simplePriceDisplay" style="display: none;"></div>
                </div>
                </div>
            </div>
            
            <!-- Metal Selection -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header">
                            <h3 class="mb-0">Select Metals to Display</h3>
                        </div>
                        <div class="card-body">
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox" id="showGold" checked>
                                <label class="form-check-label" for="showGold">
                                    <i class="fas fa-circle gold-icon"></i> Gold
                                </label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox" id="showSilver" checked>
                                <label class="form-check-label" for="showSilver">
                                    <i class="fas fa-circle silver-icon"></i> Silver
                                </label>
                            </div>
                            <div class="form-check form-check-inline">
                                <input class="form-check-input" type="checkbox" id="showPlatinum" checked>
                                <label class="form-check-label" for="showPlatinum">
                                    <i class="fas fa-circle platinum-icon"></i> Platinum
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Market Analysis -->
            <div class="row">
                <div class="col-md-6 mb-4">
                    <div class="card h-100">
                        <div class="card-header">
                            <h3 class="mb-0">Market Analysis</h3>
                        </div>
                        <div class="card-body">
                            <h4>Current Trends</h4>
                            <p>The precious metals market has shown significant volatility in recent months. Gold prices have been influenced by global economic uncertainty, inflation concerns, and central bank policies.</p>
                            
                            <h4>Key Factors Affecting Prices</h4>
                            <ul>
                                <li>Global economic conditions</li>
                                <li>Inflation rates and expectations</li>
                                <li>Interest rate policies</li>
                                <li>Currency fluctuations</li>
                                <li>Geopolitical tensions</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 mb-4">
                    <div class="card h-100">
                        <div class="card-header">
                            <h3 class="mb-0">Metal Comparison</h3>
                        </div>
                        <div class="card-body">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>Metal</th>
                                        <th>YTD Change</th>
                                        <th>1-Year High</th>
                                        <th>1-Year Low</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><i class="fas fa-circle gold-icon"></i> Gold</td>
                                        <td id="gold-ytd">+5.2%</td>
                                        <td id="gold-high">$2,074.88</td>
                                        <td id="gold-low">$1,810.20</td>
                                    </tr>
                                    <tr>
                                        <td><i class="fas fa-circle silver-icon"></i> Silver</td>
                                        <td id="silver-ytd">+3.8%</td>
                                        <td id="silver-high">$27.50</td>
                                        <td id="silver-low">$22.10</td>
                                    </tr>
                                    <tr>
                                        <td><i class="fas fa-circle platinum-icon"></i> Platinum</td>
                                        <td id="platinum-ytd">-2.1%</td>
                                        <td id="platinum-high">$1,150.00</td>
                                        <td id="platinum-low">$890.30</td>
                                    </tr>
                                </tbody>
                            </table>
                            
                            <div class="alert alert-info mt-3">
                                <i class="fas fa-info-circle"></i> These figures are for demonstration purposes. In a production environment, they would be updated with real market data.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Price Alert Section -->
    <section class="alert-section py-5 bg-light">
        <div class="container">
            <div class="row">
                <div class="col-md-6 offset-md-3 text-center">
                    <h2 class="mb-4">Get Price Alerts</h2>
                    <p>Sign up to receive email notifications when precious metal prices reach your target levels.</p>
                    <a href="#" class="btn btn-primary">Coming Soon</a>
                </div>
            </div>
        </div>
    </section>

    <!-- Related Links -->
    <section class="py-5 bg-light">
        <div class="container">
            <h2 class="h5 mb-4">Related links</h2>
            <div class="row g-3">
                <div class="col-12 col-md-6 col-lg-3">
                    <div class="card h-100">
                        <div class="card-body">
                            <h3 class="h6">Calculators</h3>
                            <ul class="mb-0">
                                <li><a href="calculator.html">Gold Calculator</a></li>
                                <li><a href="metals.html">Silver & Platinum Calculator</a></li>
                                <li><a href="multi-calculator.html">Batch Calculator</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-6 col-lg-3">
                    <div class="card h-100">
                        <div class="card-body">
                            <h3 class="h6">Learn more</h3>
                            <ul class="mb-0">
                                <li><a href="gold-education.html">Gold Education</a></li>
                                <li><a href="silver-guide.html">Silver Guide</a></li>
                                <li><a href="investment-guide.html">Investment Guide</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-6 col-lg-3">
                    <div class="card h-100">
                        <div class="card-body">
                            <h3 class="h6">Market & insights</h3>
                            <ul class="mb-0">
                                <li><a href="market.html">Market Price Charts</a></li>
                                <li><a href="blog.html">Blog</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-12 col-md-6 col-lg-3">
                    <div class="card h-100">
                        <div class="card-body">
                            <h3 class="h6">Support</h3>
                            <ul class="mb-0">
                                <li><a href="faq.html">FAQ</a></li>
                                <li><a href="contact.html">Contact</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-dark text-white py-5">
        <div class="container">
            <div class="row">
                <div class="col-lg-4 col-md-6 mb-4">
                    <h5 class="mb-3"><i class="fas fa-coins gold-icon"></i> Gold Calculator</h5>
                    <p>Professional gold and silver calculator for jewelry valuation and precious metal investments. Get accurate estimates based on real-time market prices.</p>
                    <div class="social-icons mt-3">
                        <a href="#" class="text-white me-3"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" class="text-white me-3"><i class="fab fa-twitter"></i></a>
                        <a href="#" class="text-white me-3"><i class="fab fa-instagram"></i></a>
                        <a href="#" class="text-white me-3"><i class="fab fa-linkedin-in"></i></a>
                    </div>
                </div>
                <div class="col-lg-2 col-md-6 mb-4">
                    <h5 class="mb-3">Quick Links</h5>
                    <ul class="list-unstyled">
                        <li class="mb-2"><a href="index.html" class="text-white"><i class="fas fa-angle-right me-2"></i>Home</a></li>
                        <li class="mb-2"><a href="calculator.html" class="text-white"><i class="fas fa-angle-right me-2"></i>Gold Calculator</a></li>
                        <li class="mb-2"><a href="metals.html" class="text-white"><i class="fas fa-angle-right me-2"></i>Other Metals</a></li>
                        <li class="mb-2"><a href="market.html" class="text-white"><i class="fas fa-angle-right me-2"></i>Market Charts</a></li>
                        <li class="mb-2"><a href="multi-calculator.html" class="text-white"><i class="fas fa-angle-right me-2"></i>Batch Calculator</a></li>
                    </ul>
                </div>
                <div class="col-lg-3 col-md-6 mb-4">
                    <h5 class="mb-3">Resources</h5>
                    <ul class="list-unstyled">
                        <li class="mb-2"><a href="gold-education.html" class="text-white"><i class="fas fa-angle-right me-2"></i>Gold Education</a></li>
                        <li class="mb-2"><a href="silver-guide.html" class="text-white"><i class="fas fa-angle-right me-2"></i>Silver Market Analysis</a></li>
                        <li class="mb-2"><a href="investment-guide.html" class="text-white"><i class="fas fa-angle-right me-2"></i>Investment Guide</a></li>
                        <li class="mb-2"><a href="gold-history.html" class="text-white"><i class="fas fa-angle-right me-2"></i>Gold Price History</a></li>
                        <li class="mb-2"><a href="blog.html" class="text-white"><i class="fas fa-angle-right me-2"></i>Blog</a></li>
                        <li class="mb-2"><a href="refining-services.html" class="text-white"><i class="fas fa-angle-right me-2"></i>Refining Services</a></li>
                        <li class="mb-2"><a href="dealer-program.html" class="text-white"><i class="fas fa-angle-right me-2"></i>Dealer Program</a></li>
                        <li class="mb-2"><a href="coin-melt-values.html" class="text-white"><i class="fas fa-angle-right me-2"></i>Coin Melt Values</a></li>
                        <li class="mb-2"><a href="live-karat-prices.html" class="text-white"><i class="fas fa-angle-right me-2"></i>Live Karat Prices</a></li>
                        <li class="mb-2"><a href="faq.html" class="text-white"><i class="fas fa-angle-right me-2"></i>FAQ</a></li>
                    </ul>
                </div>
                <div class="col-lg-3 col-md-6 mb-4">
                    <h5 class="mb-3">Contact & Legal</h5>
                    <ul class="list-unstyled">
                        <li class="mb-2"><i class="fas fa-envelope me-2"></i> shichuhui19@gmail.com</li>
                        <li class="mb-2"><a href="contact.html" class="text-white"><i class="fas fa-angle-right me-2"></i>Contact Us</a></li>
                        <li class="mb-2"><a href="about.html" class="text-white"><i class="fas fa-angle-right me-2"></i>About Us</a></li>
                        <li class="mb-2"><a href="privacy.html" class="text-white"><i class="fas fa-angle-right me-2"></i>Privacy Policy</a></li>
                        <li class="mb-2"><a href="terms.html" class="text-white"><i class="fas fa-angle-right me-2"></i>Terms of Service</a></li>
                    </ul>
                </div>
            </div>
            <hr class="my-4 bg-secondary">
            <div class="row align-items-center">
                <div class="col-md-7">
                    <p class="mb-md-0">&copy; <span id="copyright-year">2023</span> Gold Calculator. All rights reserved.</p>
                </div>
                <div class="col-md-5 text-md-end">
                    <p class="small mb-0">Disclaimer: Gold and silver prices are indicative and for reference purposes only. Actual market prices may vary.</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Optimized JS Loading -->
    <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script defer src="js/gold-api.js"></script>

    <!-- Inline Ultra Lightweight Chart - Zero dependencies -->
    <script>
        // Ultra lightweight chart implementation
        class SimpleChart {
            constructor(canvasId, options = {}) {
                this.canvas = document.getElementById(canvasId);
                if (!this.canvas) return null;
                
                this.ctx = this.canvas.getContext('2d');
                this.options = {
                    lineColor: '#D4AF37',
                    pointColor: '#FFD700',
                    backgroundColor: '#ffffff',
                    gridColor: '#e0e0e0',
                    basePrice: 2000,
                    ...options
                };
                
                this.data = [];
                this.init();
            }
            
            init() {
                this.generateData();
                this.setupCanvas();
                this.draw();
                
                // Auto-update every 30 seconds
                setInterval(() => {
                    this.updateData();
                    this.draw();
                }, 30000);
            }
            
            setupCanvas() {
                const container = this.canvas.parentElement;
                const rect = container.getBoundingClientRect();
                
                this.canvas.width = rect.width;
                this.canvas.height = rect.height || 400;
                
                const dpr = window.devicePixelRatio || 1;
                this.canvas.width = this.canvas.width * dpr;
                this.canvas.height = this.canvas.height * dpr;
                this.ctx.scale(dpr, dpr);
                
                this.canvas.style.width = rect.width + 'px';
                this.canvas.style.height = (rect.height || 400) + 'px';
                
                window.addEventListener('resize', () => {
                    this.setupCanvas();
                    this.draw();
                });
            }
            
            generateData(days = 30) {
                const now = new Date();
                this.data = [];
                
                for (let i = days; i >= 0; i--) {
                    const date = new Date(now.getTime() - i * 24 * 60 * 60 * 1000);
                    const trend = Math.sin((days - i) / days * Math.PI * 2) * 50;
                    const noise = (Math.random() - 0.5) * 30;
                    const price = this.options.basePrice + trend + noise;
                    
                    this.data.push({
                        date: date.toISOString().split('T')[0],
                        price: Math.max(1000, price),
                        label: date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })
                    });
                }
            }
            
            updateData() {
                const lastDate = new Date(this.data[this.data.length - 1].date);
                const newDate = new Date(lastDate.getTime() + 24 * 60 * 60 * 1000);
                const lastPrice = this.data[this.data.length - 1].price;
                const change = (Math.random() - 0.5) * 20;
                const newPrice = Math.max(1000, lastPrice + change);
                
                this.data.push({
                    date: newDate.toISOString().split('T')[0],
                    price: newPrice,
                    label: newDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })
                });
                
                if (this.data.length > 31) {
                    this.data.shift();
                }
            }
            
            draw() {
                if (!this.ctx || !this.data.length) return;
                
                const width = this.canvas.width / (window.devicePixelRatio || 1);
                const height = this.canvas.height / (window.devicePixelRatio || 1);
                
                this.ctx.clearRect(0, 0, width, height);
                this.ctx.fillStyle = this.options.backgroundColor;
                this.ctx.fillRect(0, 0, width, height);
                
                this.drawGrid(width, height);
                this.drawLine(width, height);
                this.drawLabels(width, height);
                this.drawCurrentPrice(width, height);
            }
            
            drawGrid(width, height) {
                this.ctx.strokeStyle = this.options.gridColor;
                this.ctx.lineWidth = 1;
                
                for (let i = 0; i <= 5; i++) {
                    const y = (height - 80) * (i / 5) + 40;
                    this.ctx.beginPath();
                    this.ctx.moveTo(60, y);
                    this.ctx.lineTo(width - 20, y);
                    this.ctx.stroke();
                }
                
                const step = Math.max(1, Math.floor(this.data.length / 6));
                for (let i = 0; i < this.data.length; i += step) {
                    const x = 60 + (width - 80) * (i / (this.data.length - 1));
                    this.ctx.beginPath();
                    this.ctx.moveTo(x, 40);
                    this.ctx.lineTo(x, height - 40);
                    this.ctx.stroke();
                }
            }
            
            drawLine(width, height) {
                if (this.data.length < 2) return;
                
                const chartWidth = width - 80;
                const chartHeight = height - 100;
                const minPrice = Math.min(...this.data.map(d => d.price));
                const maxPrice = Math.max(...this.data.map(d => d.price));
                const priceRange = maxPrice - minPrice || 1;
                
                this.ctx.strokeStyle = this.options.lineColor;
                this.ctx.lineWidth = 3;
                this.ctx.beginPath();
                
                this.data.forEach((point, index) => {
                    const x = 60 + chartWidth * (index / (this.data.length - 1));
                    const y = 50 + chartHeight * (1 - (point.price - minPrice) / priceRange);
                    
                    if (index === 0) {
                        this.ctx.moveTo(x, y);
                    } else {
                        this.ctx.lineTo(x, y);
                    }
                });
                
                this.ctx.stroke();
                
                this.ctx.fillStyle = this.options.pointColor;
                this.data.forEach((point, index) => {
                    const x = 60 + chartWidth * (index / (this.data.length - 1));
                    const y = 50 + chartHeight * (1 - (point.price - minPrice) / priceRange);
                    
                    this.ctx.beginPath();
                    this.ctx.arc(x, y, 4, 0, 2 * Math.PI);
                    this.ctx.fill();
                });
            }
            
            drawLabels(width, height) {
                this.ctx.fillStyle = this.options.textColor || '#333';
                this.ctx.font = '12px Arial';
                this.ctx.textAlign = 'center';
                
                const step = Math.max(1, Math.floor(this.data.length / 6));
                this.data.forEach((point, index) => {
                    if (index % step === 0) {
                        const x = 60 + (width - 80) * (index / (this.data.length - 1));
                        this.ctx.fillText(point.label, x, height - 15);
                    }
                });
                
                this.ctx.textAlign = 'right';
                const minPrice = Math.min(...this.data.map(d => d.price));
                const maxPrice = Math.max(...this.data.map(d => d.price));
                
                for (let i = 0; i <= 5; i++) {
                    const price = minPrice + (maxPrice - minPrice) * (1 - i / 5);
                    const y = (height - 100) * (i / 5) + 55;
                    this.ctx.fillText('$' + price.toFixed(2), 55, y);
                }
            }
            
            drawCurrentPrice(width, height) {
                if (this.data.length === 0) return;
                
                const currentPrice = this.data[this.data.length - 1].price;
                const minPrice = Math.min(...this.data.map(d => d.price));
                const maxPrice = Math.max(...this.data.map(d => d.price));
                const priceRange = maxPrice - minPrice || 1;
                
                const x = 60 + (width - 80) * ((this.data.length - 1) / (this.data.length - 1));
                const y = 50 + (height - 100) * (1 - (currentPrice - minPrice) / priceRange);
                
                this.ctx.fillStyle = '#ff6b6b';
                this.ctx.beginPath();
                this.ctx.arc(x, y, 6, 0, 2 * Math.PI);
                this.ctx.fill();
                
                this.ctx.fillStyle = '#ff6b6b';
                this.ctx.font = 'bold 14px Arial';
                this.ctx.textAlign = 'left';
                this.ctx.fillText('$' + currentPrice.toFixed(2), x + 15, y + 5);
            }
        }
        
        // Initialize charts when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                const marketCanvas = document.getElementById('priceHistoryChart');
                if (marketCanvas) {
                    window.marketChart = new SimpleChart('priceHistoryChart', {
                        lineColor: '#D4AF37',
                        pointColor: '#FFD700',
                        backgroundColor: '#ffffff',
                        gridColor: '#e0e0e0'
                    });
                }
            }, 100);
        });
    </script>

    <!-- Analytics moved to bottom -->
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-DHFJF4DKPM');
    </script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-DHFJF4DKPM"></script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3389504348016979" crossorigin="anonymous"></script>
</body>
</html>